{% extends '../layout.html' %}
{%load static%}
{%block style%}
<link rel="stylesheet" type="text/css" href="{%static 'css/dashboard/quotes.css'%}">

{%endblock%}
{%block content%}

<section class="">
  <table class="table">
    <thead>
      <tr>
        <th>User</th>
        <th>Project</th>
        <th>Quotation</th>
        <th>Appointment</th>
        <th>Confirmed</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>

      {%for project in projects%}
      <tr>
        <td>
          <span>
            {{project.owner.user|title}}
          </span>
        </td>
        <td>
          <span>
            {{project.name}}
          </span>
        </td>
        <td>
          {{project.quote.quotation}}
          <span>
            {%if project.quote.is_confirmed%}
            <a href="" class="btn"><i class="fas fa-check text-success"></i></a>
            {%else%}
            <a href="" class="btn "><i class="fas fa-times-circle text-danger"></i></a>

            {%endif%}
          </span>
        </td>
        <td>
          <span>
            {%if not project.quote.appointment%}
            <a href="" class="btn "><i class="fas fa-times-circle text-danger"></i></a>
            {%else%}
            {%if project.quote.appointment.is_confirmed%}
            {{project.quote.appointment.date}}
            {{project.quote.appointment.time}}
            {%else%}
            <span class="text-warning">Pending</span>
            {%endif%}

            {%endif%}
          </span>
        </td>

        <td>
          <span>
            {%if quote.is_confirmed%}
            <a href="" class="btn btn-success"><i class="fas fa-check text-success"></i></a>
            {%else%}
            <a href="" class="btn "><i class="fas fa-times-circle text-danger"></i></a>

            {%endif%}
          </span>
        </td>
        <td>
          <span>
            {%if not project.quote.appointment%}
            <a class="btn btn-sm btn-outline-danger" href="{%url 'host-appointment' project.id%}"><i class="far fa-calendar-times text-danger"></i></a>
            {%else%} 
            {%if not project.quote.is_confirmed%}
            <a class="btn btn-sm btn-outline-danger text-danger" data-toggle="modal" data-target="#quotationModal" ><i class="fas fa-money-check-alt"></i></a>
            {%endif%}
            {%endif%}
            
            
            <a class="btn btn-sm btn-outline-primary text-primary" data-toggle="modal" data-target="#exampleModal"><i
                class="far fa-eye"></i></a>
            
          </span>
        </td>
      </tr>


      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Quote View</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <h5>Quote</h5>
              <p><b>Bedrooms:</b>{{quote.bedrooms}}</p>
              <p><b>system_required:</b>{{quote.system_required}}</p>
              <p><b>system_control:</b>{{quote.system_control}}</p>
              <p><b>description:</b>{{quote.description}}</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Save changes</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Quotation form modal -->
      <div class="modal fade" id="quotationModal" tabindex="-1" role="dialog" aria-labelledby="quotationModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="quotationModalLabel">Quotation Form</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form method="POST" action="{%url 'quotation' project.quote.id%}">
                {%csrf_token%}
                <div class="form-group">
                  <label for="quotation">Quotation</label>
                  <input type="text" name="quotation" id="quotation" class="form-control"/>
                </div>
              
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Save changes</button>
            </form>

            </div>
          </div>
        </div>
      </div>

      {%endfor%}
    </tbody>

  </table>
</section>







{%endblock%}